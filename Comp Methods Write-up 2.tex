%\documentclass[12pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
%\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
%\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
%\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode

\documentclass[%
 reprint,
%superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%showpacs,preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,
%pra,
%prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-1}

\usepackage{graphicx}% Include figure files
\graphicspath{{Images/}}
\usepackage{float}
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
%\usepackage{hyperref}% add hypertext capabilities
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}

\usepackage{mathrsfs}
\usepackage{amsmath}

\begin{document}
\bibliographystyle{unsrtnat}

\preprint{APS/123-QED}

\title{Computationally Calculating Expectation Values for the Time Independent Schrodinger Equation}

\author{Anne Stratman and Ben Riordan}
\affiliation{%
Computational Lab in Quantum Mechanics, Spring 2018, University of Notre Dame}%

\maketitle								% TeX will automatically convert eps --> pdf in pdflatex		
%\usepackage{amssymb}

%SetFonts

%SetFonts


%\title{Brief Article}
%\author{The Author}
%\date{}							% Activate to display a given date or no date
%\maketitle
%\section{}
%\subsection{}

\noindent \textbf{Introduction}\\

The one-dimensional time-independent Schrodinger equation is as follows:

\begin{equation}
-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}\psi(x)+V(x)\psi(x)=E\psi(x)
\end{equation}

The eigenfunctions and eigenvalues of the Hamiltonian ($-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}+V(x)$) are the allowed wave functions and energies, respectively, for a given potential.  After finding the allowed wave functions, one can calculate expectation values, which give the average value of an observable measured in many identically prepared systems.  Suppose we have a set of $\psi_n$'s corresponding to a particular potential.  To calculate the expectation value of an observable \textit{o}, one acts the operator corresponding to that expectation value on the \textit{n}$^{th}$ wave function, and takes the inner product of the \textit{n}$^{th}$ wave function with this quantity:

\begin{equation}
\langle o \rangle = \langle \psi_n | \hat{o} | \psi_n \rangle
\end{equation}

Commonly calculated expectation values (for one-dimensional wave functions) include position (\textit{x}), position squared (\textit{x}$^2$), momentum (\textit{p}), and momentum squared (\textit{p}$^2$).

Any of the aforementioned expectation values can be calculated computationally by solving the TISE as a matrix eigenvalue problem to find a set of allowed wave functions, representing the eigenfunctions as a matrix, defining the requisite operator matrix, and writing the expectation value calculation as matrix multiplication.  Suppose we have a set of eigenfunctions ($\psi_n$'s) for a particular potential.  We can represent this set of eigenfunctions in matrix form as

\[
A = 
\begin{bmatrix}
| & | & ... & | \\
\psi_1 & \psi_2 & ... & \psi_n \\
| & | & ... & | \\
... & ... & ... & ... \\
\end{bmatrix}
\]

where each matrix element $a_{mn}$ gives the $m^{th}$ element of the $n^{th}$ wave function.
The operator corresponding to $\langle$\textit{x}$\rangle$ multiplies $\psi_n$ by \textit{x}.  Hence, the operator matrix for $\langle$\textit{x}$\rangle$ must be diagonal, and can be written as:

\[
\hat{x} = 
\begin{bmatrix}
x & 0 & 0 & ... \\
0 & x & 0 & ... \\
... & ... & ... & ... \\
... & 0 & 0 & x\\
\end{bmatrix}
\]

Multiplying the two matrices $\langle\hat{x}\rangle$ and \textit{A} gives

\[
\hat{x}A = 
\begin{bmatrix}
x\psi_1 & 0 & ... & 0 \\
0 & x\psi_2 & ... & 0 \\
... & ... & ... & ... \\
... & 0 & 0 & x\psi_n \\
\end{bmatrix}
\]

Taking the transpose conjugate of the matrix \textit{A} to rewrite the eigenvector matrix in row form, and multiplying the matrix $\hat{x}A$ by this matrix from the left, results in a matrix with the expectation values of $\hat{x}$ for each $\psi_n$ along the diagonal.  Any non-diagonal elements in this matrix are the matrix elements for transitions between the $\psi_{m^{th}}$ and $\psi_{n^{th}}$ states.  Non-zero diagonal elements show that a transition between the $\psi_{m^{th}}$ and $\psi_{n^{th}}$ states is non allowed.

To find $\langle x^2 \rangle$, the operator matrix is defined with $x^2$ along the diagonal, as opposed to \textit{x}.  The rest of the procedure is identical to that described above.

\end{document}